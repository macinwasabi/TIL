# DI

- [DI](#di)
  - [DIとは](#diとは)
    - [依存性](#依存性)
  - [メリット](#メリット)
    - [改修が容易になる](#改修が容易になる)
    - [オブジェクトの差し替えが容易に](#オブジェクトの差し替えが容易に)
    - [オブジェクト生成を自動](#オブジェクト生成を自動)
    - [依存関係の解決](#依存関係の解決)
  - [デメリット](#デメリット)
  - [DIコンテナ](#diコンテナ)
  - [DIのやり方](#diのやり方)
  - [IoC](#ioc)
  - [AOP](#aop)
  - [DIP](#dip)
  - [疑問](#疑問)

## DIとは

Dependency Injectionの略で、直訳すると依存性の注入。インターフェースに依存し、具体的なコンポーネントの選択は外部で定義することで、依存関係を薄くする。

### 依存性

あるオブジェクトが他のオブジェクト(、定数、変数)を参照していること。

## メリット

### 改修が容易になる

依存しているクラスの改修が、他のクラスに影響することを減らせる。例えば、クラスを削除した場合(TODO:他に影響する例は？)。

実装を分担しやすい。拡張性。

### オブジェクトの差し替えが容易に

単体テスト時にモックを入れるなどできる。変更に強い、保守性。

### オブジェクト生成を自動

newする処理をプログラム内に書かずに済む(関心の分離)。DIコンテナがインスタンスを管理するから、インスタンス化を不要に行わない。メモリ管理を行なってくれる(TODO:どのように？)

### 依存関係の解決

依存しているオブジェクトの依存も解決してくれる。

## デメリット

外部の設定ファイルが肥大化しやすい。ただ、アノテーションで改善している。

インターフェースを理解していないと実装が難しい。

クラスを分けていくので工数がかかったり。

実行速度が遅くなってしまうことがある。

## DIコンテナ

VMとメモリ空間は別になるのか？(TODO:要調査)。別なら本処理にリソースがさけてありがたい...?
そもそもDIコンテナはどこで動いてる？(TODO)

## DIのやり方

[Spring FrameworkでDIする3つの方法](https://reasonable-code.com/spring-injection-method/)を参照。

## IoC

制御の反転(inversion of Control)。

プロシージャを「呼び出す側」と「呼び出される側」が、従来とは逆になるようにすること。
(TODO:要具体)

## AOP

アスペクト指向プログラミング。オブジェクトを跨った処理(横断的関心事)を切り出すことで、関心の分離を行うこと。

## DIP

依存性逆転の原則(Dependency Inversion Principle)。

[DI(依存性注入) / DIP(依存性逆転の原則) なにそれおいしいの？ - Zenn](https://zenn.dev/web_tips/articles/82671ac0adb448#dip)の通り。オニオンアーキテクチャ達みたい(TODO:多分そういうこと)。

## 疑問

- TODO:しかしMockitoでサービスをモック化する時はインターフェースに依存してないから本来のDIとは少し違う気がするけど、いかが？
